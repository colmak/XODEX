# VERIFICATION REPORT: 2026-02-18

## EXECUTIVE SUMMARY
- Total towers found in `tower_definitions.json`: **8**.
- Fully implemented runtime-specific tower scripts (`ThermalTower.gd`, `CrystalTower.gd`) found: **0** (runtime currently uses dictionary-driven generic tower handling in `level_scene.gd`).
- Synthesis-capable towers with explicit recipes in JSON: **0** (no `synthesis_paths` entries are defined in tower JSON; bond graph exists as adjacency/affinity system).
- Control schemes verified from code/documentation: **3 clearly implemented touch controls** (tap place, long-press info, two-finger retry), with drag placement also implemented via `TowerPlacementController` even though README gameplay controls do not enumerate it.

## TOWER INVENTORY

### A.1 JSON Source Verification (`android/BurzenTD/data/towers/tower_definitions.json`)

Observed schema is **not** the requested schema. Current keys are:
`tower_id`, `display_name`, `scene_path`, `residue_class`, `heat_gen_rate`, `heat_tolerance`, `preferred_bind`, `folding_role`, `build_cost`, `heat_tolerance_value`, `affinity_modifiers`, `special_ability`, `tooltip`, `visuals`, plus localized names.

Missing from requested format across all towers:
- `category`
- `base_stats.damage`, `base_stats.range`, `base_stats.attack_speed`, `base_stats.thermal_generation`, `base_stats.cost`
- structured `residue_slots`
- structured `synthesis_paths`
- `visual_assets` object (`icon_path`, `projectile_scene`, `impact_effect`)
- `upgrade_paths`
- `unlock_conditions`
- `tags`

| tower_id | display_name | residue_class | heat_gen_rate | heat_tolerance | preferred_bind | folding_role | build_cost | heat_tolerance_value | scene_path |
|---|---|---:|---:|---|---|---|---:|---:|---|
| hydrophobic_anchor | Hydrophobic Anchor | nonpolar | 1.15 | medium | nonpolar | core_damage | 14 | 0.75 | `res://towers/tower_01_hydrophobic_anchor.tscn` |
| polar_hydrator | Polar Hydrator | polar_uncharged | 0.35 | high | charged | cooling_slow | 12 | 0.95 | `res://towers/tower_02_polar_hydrator.tscn` |
| cationic_defender | Cationic Defender | positively_charged | 0.75 | medium | negatively_charged | anti_mob_repulsion | 15 | 0.70 | `res://towers/tower_03_cationic_defender.tscn` |
| anionic_repulsor | Anionic Repulsor | negatively_charged | 0.78 | medium | positively_charged | barrier_reinforcement | 15 | 0.70 | `res://towers/tower_04_anionic_repulsor.tscn` |
| proline_hinge | Proline Hinge | special | 0.30 | high | any | turn_connector | 10 | 1.00 | `res://towers/tower_05_proline_hinge.tscn` |
| alpha_helix_pulsar | Alpha-Helix Pulsar | nonpolar_special | 1.20 | low | linear_chains | rhythmic_pulse_damage | 18 | 0.55 | `res://towers/tower_06_alpha_helix_pulsar.tscn` |
| beta_sheet_fortifier | Beta-Sheet Fortifier | polar_uncharged | 0.25 | high | parallel_antiparallel_ladders | defense_barrier | 17 | 1.05 | `res://towers/tower_07_beta_sheet_fortifier.tscn` |
| molecular_chaperone | Molecular Chaperone | keystone | -0.45 | very_high | any | global_heat_management | 20 | 1.30 | `res://towers/tower_08_molecular_chaperone.tscn` |

Raw extract: `docs/reports/raw/tower_definitions_export.json`.

### A.2 Demo Campaign Towers (`android/BurzenTD/levels/demo/`)

`*.tscn` files are placeholders with only root nodes; actionable configuration is in matching `*.json` loaded by `LevelManager`.

| Level File | Towers Present | Starting Loadout | Unlock Conditions |
|---|---|---|---|
| level_01_first_fold.tscn + .json | hydrophobic_anchor, polar_hydrator, molecular_chaperone | Same as unlocked set | Implicit campaign progression only (no per-level unlock expression in file) |
| level_02_thermal_balance.tscn + .json | hydrophobic_anchor, polar_hydrator, cationic_defender, anionic_repulsor, molecular_chaperone | Same | Implicit progression |
| level_03_neighbor_bonds.tscn + .json | hydrophobic_anchor, polar_hydrator, cationic_defender, anionic_repulsor, proline_hinge | Same | Implicit progression |
| level_04_tissue_emergence.tscn + .json | hydrophobic_anchor, polar_hydrator, cationic_defender, anionic_repulsor, proline_hinge, alpha_helix_pulsar, beta_sheet_fortifier | Same | Implicit progression |
| level_05_pathway_design.tscn + .json | all 8 demo towers | Same | Implicit progression |

Raw extract: `docs/reports/raw/demo_levels_export.json`.

### A.3 Tower Taxonomy Classification vs v0.00.4.0 mockup

Mockup (`td_v0_00_4_mockup.gd`) taxonomy: `triangle`, `square`, `rectangle` (Geometric), `fire`, `water`, `earth`, `air` (Elemental), `keystone` (Keystone).

Current runtime/data taxonomy: residue-biochemistry-themed towers (hydrophobic/polar/cationic/anionic/etc.).

| Tower ID | Geometric Class | Elemental Class | Keystone Type | Synthesis Role |
|---|---|---|---|---|
| hydrophobic_anchor | N/A in current data | N/A | Not marked | Donor/acceptor not explicitly modeled |
| polar_hydrator | N/A | N/A | Not marked | Not explicitly modeled |
| cationic_defender | N/A | N/A | Not marked | Not explicitly modeled |
| anionic_repulsor | N/A | N/A | Not marked | Not explicitly modeled |
| proline_hinge | N/A | N/A | Not marked | Not explicitly modeled |
| alpha_helix_pulsar | N/A | N/A | Not marked | Not explicitly modeled |
| beta_sheet_fortifier | N/A | N/A | Not marked | Not explicitly modeled |
| molecular_chaperone | N/A | N/A | **Closest to keystone** (`residue_class = keystone`) | Not explicitly modeled |

Conclusion: mockup taxonomy and production JSON taxonomy are currently divergent.

## CONTROL MAPPING

### B.1 Touch Control Verification (code-verified)

| Control Action | Thermal Cannon | Crystal Shard | Other Towers | Works? | Edge Cases |
|---|---|---|---|---|---|
| Tap placement | N/A (tower type not present) | N/A | ✅ yes | ✅ | Placement rejected near path, occupied, outside arena, or over heat budget |
| Long-press highlight | N/A | N/A | ⚠️ long-press on tower *card* shows tower info; runtime long-press heat pulse behavior from README is not explicitly implemented in current `level_scene.gd` | ⚠️ partial | Distinction between card long-press and in-arena tower interaction |
| Two-finger retry | N/A | N/A | ✅ yes | ✅ | Uses short timer window (`TWO_FINGER_WINDOW`) |
| Drag to rotate | N/A | N/A | ❌ no | ❌ | No rotation API in runtime |
| Pinch zoom | N/A | N/A | ❌ no | ❌ | Camera has follow/zoom variable but no pinch gesture handler |

### B.2 Tower-Specific Interactions

| Tower Type | Special Control | Visual Feedback | Works? |
|---|---|---|---|
| Thermal Cannon | Double-tap to vent heat | Red pulse | ❌ not found |
| Crystal Shard | Swipe to rotate focus | Blue highlight | ❌ not found |
| Synthesized | Bond drag connection | Glow line | ⚠️ no drag-to-bond; bond lines auto-render based on adjacency/affinity |

### B.3 Synthesis Activation Controls

| Synthesis Action | Current Control | Proposed Control | Status |
|---|---|---|---|
| Select two towers | No explicit synthesis select flow | Drag between towers | Unknown / not implemented |
| Confirm synthesis | None | Button or tap both | Unknown / not implemented |
| Cancel pending bond | None | Tap elsewhere | Unknown / not implemented |
| View recipe preview | None | Long-press tower | Unknown / not implemented |

## RUNTIME SCRIPT VERIFICATION

### C.1 Core Script Inventory

| Script | Purpose | Tower Dependencies | Last Updated | Status |
|---|---|---|---|---|
| `ResidueEngine.gd` | Residue slot normalization and tower residue classification helpers | Generic/all | Not timestamped in file content | Implemented utility |
| `AffinityTable.gd` | Compatibility matrix + pair evaluation | Generic/all | Header notes v0.00.6.1 | Implemented |
| `TowerGraph.gd` | Bond graph generation from neighboring towers | Generic/all | Header strict typing note | Implemented |
| `ThermalTower.gd` | Thermal behavior | Thermal Cannon | N/A | **Missing file** |
| `CrystalTower.gd` | Crystal behavior | Crystal Shard | N/A | **Missing file** |
| `td_v0_00_4_mockup.gd` | Mockup UI/tower drag placement prototype | Mockup-only 8 tower taxonomy | Header v0.01.0 | Mockup present |

### C.2 Property Exposure Verification

`TowerBase` exported properties:
- `@export var tower_id`
- `@export var residue_class`
- `@export var heat_gen_rate`
- `@export var heat_tolerance`
- `@export var preferred_bind`
- `@export var special_ability`

Not exported in `TowerBase`:
- `damage`
- `range`
- `attack_speed`
- structured `residue_slots`
- `synthesis_cooldown`

Runtime creates placed towers as dictionaries in `level_scene.gd` with keys such as `pos`, `radius`, `thermal`, `last_target`, then merges JSON definition. Thermal runtime state (`thermal.heat`, `thermal.capacity`, `thermal.overheated`) is runtime-only.

### C.3 Signal Connections

| Signal | Emitted By | Listened By | Verified? |
|---|---|---|---|
| `tower_placed` | N/A | N/A | ❌ not found |
| `tower_synthesized` | N/A | N/A | ❌ not found |
| `thermal_overheat` | N/A explicit signal | N/A explicit listener | ❌ not found as signal (overheat handled by state flag) |
| `bond_formed` | N/A | N/A | ❌ not found |
| `graph_delta_ready` | `TowerGraph` | Callers may inspect return payload; no persistent listener in `level_scene.gd` | ✅ emitted but not used as global signal bus |

## VISUAL ASSET VERIFICATION

### D.1 Tower Scene Files (`android/BurzenTD/towers/`)

| Tower | Scene File Exists? | Materials | Animations | Particle Effects |
|---|---|---|---|---|
| Thermal Cannon | ❌ no matching scene | — | — | — |
| Crystal Shard | ❌ no matching scene | — | — | — |
| Plasma Cannon | ❌ no matching scene | — | — | — |
| Permafrost Beacon | ❌ no matching scene | — | — | — |
| Current 8 biochemical towers | ✅ yes (`tower_01...tower_08`) | ⚠️ none in file text | ⚠️ none in file text | ⚠️ none in file text |

### D.2 Bond Visualization

No `BondRenderer.gd` script found.
Bond rendering currently implemented in `ArenaViewport._draw_bonds()` as simple colored lines by strength.

| Bond Type | Visual Style | Implemented? | Shader Used |
|---|---|---|---|
| Elemental | Not separately typed | ⚠️ generic line only | None |
| Geometric | Not separately typed | ⚠️ generic line only | None |
| Keystone | Not separately typed | ⚠️ generic line only | None |

### D.3 UI Icons

No tower icon assets found under `android/BurzenTD/assets/towers/` despite search paths in `TowerSelectionPanel.gd`; panel falls back to glyphs.

| Tower Icon | Exists? | Path | Size | Format |
|---|---|---|---|---|
| Hydrophobic Anchor | ❌ | N/A | N/A | N/A |
| Polar Hydrator | ❌ | N/A | N/A | N/A |
| ...all 8 demo towers | ❌ | N/A | N/A | N/A |

## SIMULATION LAYER VERIFICATION

### E.1 Python Test Coverage (`simulation/`)

Requested files `test_thermal.py`, `test_synthesis.py`, `test_placement.py` do not exist by those names.

Actual test files include:
- `test_thermal_reference.py`
- `test_heat_engine.py`
- `test_tower_graph.py`
- `test_tower_wave_settings.py`
- `test_basic_mechanics.py`
- additional fold/protein/campaign tests

Requested command executed:
```bash
./scripts/run_tests.sh --verbose --coverage --towers=all
```
Result: **PASS**, 33 tests OK.

Raw output: `docs/reports/raw/run_tests_verbose_coverage_towers_all.txt`.

### E.2 Haskell Proofs (`simulation/haskell/`)

Requested files `SynthesisRules.hs` and `ThermalConservation.hs` are not present.

Present files:
- `BURZEN_Folding_v0_01_0.hs`
- `BURZEN_TowerGraph_v0_00_5_0.hs`
- `BURZEN_v0_00_3_0.hs`

Execution attempt with `runghc` failed due missing tool in environment.

## DOCUMENTATION GAP ANALYSIS

### F.1 Missing Documentation

| Document | Should Contain | Exists? |
|---|---|---|
| Tower design spec | Each tower's intended role | ⚠️ Partially (roles in JSON and some docs, no dedicated canonical spec doc) |
| Synthesis recipe book | All combinations | ❌ not found |
| Control scheme guide | All touch gestures | ⚠️ README has partial controls only |
| JSON schema doc | Property descriptions | ❌ no dedicated tower schema doc found |

### F.2 Inconsistent Documentation

| Topic | Documented In | Actual Behavior | Match? |
|---|---|---|---|
| Number of towers | README references 8-tower data | JSON currently has 8 towers | ✅ |
| Synthesis rules | docs/foldgraph discusses bond graph and affinity | Runtime has bond graph but no explicit recipe synthesis activation flow | ⚠️ partial |
| Thermal mechanics | README `v0.00.3.0` stable thermal loop | Runtime and tests include thermal state/overheat behavior | ✅ |

## SPECIFIC VERIFICATION QUERIES

### G.1 Critical Unknowns
1. How many towers in `tower_definitions.json`? **8**.
2. Which towers have working synthesis paths? **None have explicit `synthesis_paths`; all can contribute to auto-generated bond lines if adjacent.**
3. Are the 8 demo towers the same as JSON towers? **Yes, level unlock sets use the same 8 IDs from JSON.**
4. Actual residue slots for each tower? **No per-tower `residue_slots` in JSON; `ResidueEngine` can normalize fallback slots algorithmically.**
5. Do geometric towers exist in code or just mockups? **They exist in mockup script (`td_v0_00_4_mockup.gd`) only, not in current campaign JSON/runtime tower list.**

### G.2 Control System Questions
1. How do players initiate synthesis in current build? **They do not explicitly initiate synthesis; bond graph is auto-computed from placed adjacent towers.**
2. Visual feedback for valid synthesis partners? **Indirectly yes via rendered bond lines; no explicit “valid partner” targeting UI.**
3. Can towers be moved after placement? **No move mechanic found; only sell/remove then re-place.**
4. Tap vs long-press? **Tap selects in-arena tower info; long-press on tower cards emits info request; no separate in-arena long-press tower-heat pulse implementation located in runtime script.**

### G.3 Synthesis Questions
1. Current synthesis recipes? **None explicitly encoded as recipes.**
2. Do synthesized towers persist between waves? **No synthesized tower entity/state found.**
3. Can towers be de-synthesized? **Not applicable with current implementation.**
4. Is thermal cost implemented for synthesis? **No explicit synthesis thermal cost found.**

## CRITICAL FINDINGS
1. **Schema divergence:** runtime tower JSON is missing requested structured fields (`base_stats`, `residue_slots`, `synthesis_paths`, visual asset paths), making tower-definition validation against requested schema currently impossible without adapter work.
2. **Mechanic divergence:** current “synthesis” implementation is affinity bond visualization + win-condition bond count, not player-driven tower synthesis recipes.
3. **Taxonomy drift:** v0.00.4.0 mockup geometric/elemental/keystone tower set is not the same taxonomy as current biochemical campaign tower dataset.

## RECOMMENDATIONS
1. Introduce a versioned tower schema (`tower_schema_v1`) with explicit compatibility layer mapping old keys (`heat_gen_rate`, `build_cost`) into requested `base_stats` and structured fields.
2. Decide whether synthesis is graph-based passive bonding or active tower-transformation recipes, then implement consistent control/UI signals (`tower_synthesized`, partner preview, confirmation/cancel flow).
3. Align docs + assets: create canonical tower spec and recipe book; add icon assets or remove dead icon path assumptions in UI.

## RAW DATA
- `docs/reports/raw/tower_definitions_export.json`
- `docs/reports/raw/demo_levels_export.json`
- `docs/reports/raw/tower_scene_inventory.json`
- `docs/reports/raw/run_tests_verbose_coverage_towers_all.txt`
