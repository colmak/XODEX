{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://xodex.dev/schema/fold_record_v1.schema.json",
  "title": "FoldRecord v1",
  "type": "object",
  "required": [
    "fold_version",
    "map_seed",
    "river_slice",
    "towers",
    "bonds",
    "domains",
    "global_energy",
    "conformation_history",
    "misfold_events"
  ],
  "properties": {
    "fold_version": { "const": 1 },
    "map_seed": { "type": "integer" },
    "river_slice": {
      "type": "array",
      "items": {
        "type": "array",
        "prefixItems": [{ "type": "integer" }, { "type": "integer" }],
        "minItems": 2,
        "maxItems": 2
      }
    },
    "towers": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "residue_class", "pos", "thermal_state"],
        "properties": {
          "id": { "type": "integer" },
          "residue_class": { "enum": ["polar", "nonpolar", "charged+", "charged-", "special"] },
          "pos": {
            "type": "array",
            "prefixItems": [{ "type": "integer" }, { "type": "integer" }],
            "minItems": 2,
            "maxItems": 2
          },
          "thermal_state": { "type": "number" }
        }
      }
    },
    "bonds": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["from_id", "to_id", "type", "strength", "energy_contrib"],
        "properties": {
          "from_id": { "type": "integer" },
          "to_id": { "type": "integer" },
          "type": { "enum": ["hbond", "hydrophobic", "electrostatic", "vdw", "steric"] },
          "strength": { "type": "number" },
          "energy_contrib": { "type": "number" }
        }
      }
    },
    "domains": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "motif_type", "stability", "function", "bounding_box"],
        "properties": {
          "id": { "type": "string" },
          "motif_type": { "type": "string" },
          "stability": { "type": "number" },
          "function": { "type": "string" },
          "bounding_box": {
            "type": "array",
            "prefixItems": [
              { "type": "integer" },
              { "type": "integer" },
              { "type": "integer" },
              { "type": "integer" }
            ],
            "minItems": 4,
            "maxItems": 4
          }
        }
      }
    },
    "global_energy": { "type": "number" },
    "conformation_history": { "type": "array", "items": { "type": "number" } },
    "misfold_events": { "type": "array", "items": { "type": "string" } }
  }
}
